% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/project_setup_and_execution.R
\name{run_swat}
\alias{run_swat}
\title{Run SWAT model with or without parameter updates}
\usage{
run_swat(
  TxtInOut_dir = getwd(),
  swat_exe_path,
  execution_mode = "exe",
  parameter_info = NULL,
  subbasins = NULL,
  parameter_sample = NULL,
  output_rch_args = NULL,
  output_sub_args = NULL,
  output_hru_args = NULL,
  cores = 1
)
}
\arguments{
\item{TxtInOut_dir}{character. Path to the SWAT \code{TxtInOut} folder.
Defaults to \code{getwd()}.}

\item{swat_exe_path}{character. Path to the SWAT executable (e.g.,
\code{"swat.exe"}). On Windows, see \link{download_swat_exe}; on
Linux/macOS compile from source.}

\item{execution_mode}{character. One of \code{"exe"}, \code{"single_sample"},
or \code{"multiple_sample"}.}

\item{parameter_info}{data.frame. Parameter definitions used to update SWAT
inputs (required for \code{"single_sample"} and \code{"multiple_sample"}).
Minimum columns:
\itemize{
  \item \code{component} (e.g., \code{".gw"}, \code{".mgt"})
  \item \code{parameter} (name in SWAT input)
  \item \code{value} (numeric; value or factor)
  \item \code{method} (character; \code{"v"} or \code{"r"})
}
Optional: \code{version} (\code{"SWAT"} or \code{"SWAT_T"}), and
\code{plant_type} (for \code{plant.dat}). Passed to
\link{change_multiple_parameters}.}

\item{subbasins}{numeric. Subbasin IDs where changes apply. \code{NULL}
applies to all. Passed to \link{change_multiple_parameters}.}

\item{parameter_sample}{data.frame. Parameter sets for
\code{"multiple_sample"}; each row is one set whose column order matches
\code{parameter_info}. Passed to \link{change_multiple_parameters}.}

\item{output_rch_args}{list. Arguments for \link{output_rch}.}

\item{output_sub_args}{list. Arguments for \link{output_sub}.}

\item{output_hru_args}{list. Arguments for \link{output_hru}.}

\item{cores}{integer. CPU cores for \code{"multiple_sample"} (parallel).
Default \code{1} (sequential).}
}
\value{
\itemize{
  \item \code{"exe"}: Integer SWAT exit code (\code{0} = success).
  \item \code{"single_sample"}, \code{"multiple_sample"}: A list with any of
        \code{$rch}, \code{$sub}, \code{$hru} if the corresponding
        \code{*_args} were provided.
}
}
\description{
Executes a SWAT project in one of three modes:
\itemize{
  \item \strong{"exe"}: Run SWAT without modifying parameters (as-is).
  \item \strong{"single_sample"}: Update one parameter set, run, extract
        outputs (e.g., apply calibrated params).
  \item \strong{"multiple_sample"}: Iterate over many parameter sets; for
        each set, update inputs, run, extract outputs, then restore.
}

Internally, this function integrates:
\enumerate{
  \item \link{change_multiple_parameters} to update inputs.
  \item \link{run_swat_exe} to execute SWAT.
  \item \link{output_rch}, \link{output_sub}, \link{output_hru} to extract
        outputs.
}

For batch runs, \link{create_calibration_project} is recommended; it creates
a safe copy with a \code{Backup} folder used to restore inputs between runs.

\strong{Note:} In \code{"multiple_sample"} mode you must pass at least one
of \code{output_rch_args}, \code{output_sub_args}, or \code{output_hru_args}
to retrieve model outputs; otherwise no outputs are extracted.
}
\examples{
\donttest{
if (.Platform$OS.type == "windows") {
  old_wd <- getwd()
  on.exit(setwd(old_wd), add = TRUE)

  # Example SWAT project
  tmpdir <- tempdir()
  get_swat_example(tmpdir)

  # Create calibration project (adds Backup)
  create_calibration_project(
    swat_TxtInOut   = file.path(tmpdir, "TxtInOut"),
    destination_dir = tmpdir,
    project_name    = "calib_project",
    set_working_dir = TRUE
  )

  # Download SWAT executable
  exe_path <- download_swat_exe(dest_dir = tmpdir, type = "release")

  # Configure project
  setup_swat(
    sim_start_date = "2010-01-01",
    sim_end_date   = "2015-12-31",
    time_step      = "daily",
    NYSKIP         = 1,
    rch_vars       = c("FLOW_OUTcms", "SEDCONCmg/L"),
    sub_vars       = c("PRECIPmm", "ETmm"),
    hru_vars       = c("PRECIPmm"),
    hrus           = c(1, 2, 3)
  )

  # Parameter definitions
  parameter_info <- tibble::tibble(
    component = c(".gw", ".mgt"),
    parameter = c("GW_DELAY", "CN2"),
    value     = c(30, 0.1),
    method    = c("v", "r")
  )

  # Output extraction
  output_rch_args <- list(
    file = "output.rch",
    variable = c("FLOW_OUTcms", "SEDCONCmg/L"),
    target_id = 1,
    time_step = "daily",
    output_start_date = "2011-01-01"
  )

  # Run as-is (exe)
  run_swat(getwd(), exe_path, execution_mode = "exe")

  # Multiple sets (e.g., sensitivity)
  parameter_sample <- tibble::tibble(
    GW_DELAY = c(30, 35),
    CN2      = c(0.1, 0.2)
  )
  run_swat(getwd(), exe_path, "multiple_sample",
           parameter_info   = parameter_info,
           parameter_sample = parameter_sample,
           output_rch_args  = output_rch_args,
           cores = 1)

  # Single set (e.g., calibrated)
  run_swat(getwd(), exe_path, "single_sample",
           parameter_info  = parameter_info,
           output_rch_args = output_rch_args)
}
}
}
\seealso{
\link{create_calibration_project},
  \link{change_multiple_parameters}, \link{output_rch},
  \link{output_sub}, \link{output_hru}

Other Project setup and execution: 
\code{\link{download_swat_exe}()},
\code{\link{get_swat_example}()},
\code{\link{run_swat_exe}()},
\code{\link{setup_swat}()}
}
\concept{Project setup and execution}
