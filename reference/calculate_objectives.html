<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute calibration objectives for the SWAT model — calculate_objectives • hydroSWAT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute calibration objectives for the SWAT model — calculate_objectives"><meta name="description" content='Computes objective metrics for multiobjective SWAT model calibration.
Users can define multiple objectives, each linked to spatial units such
as river reaches ("rch"), subbasins ("sub"), or HRUs
("hru"). Each objective specifies target location, variable,
performance metric, and time step. This function is called by
calibrate_swat() during optimization.'><meta property="og:description" content='Computes objective metrics for multiobjective SWAT model calibration.
Users can define multiple objectives, each linked to spatial units such
as river reaches ("rch"), subbasins ("sub"), or HRUs
("hru"). Each objective specifies target location, variable,
performance metric, and time step. This function is called by
calibrate_swat() during optimization.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydroSWAT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fernandezpalomino/hydroSWAT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute calibration objectives for the SWAT model</h1>
      <small class="dont-index">Source: <a href="https://github.com/fernandezpalomino/hydroSWAT/blob/v0.1.0/R/multiobjective-03-calculate_objectives.R" class="external-link"><code>R/multiobjective-03-calculate_objectives.R</code></a></small>
      <div class="d-none name"><code>calculate_objectives.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes objective metrics for multiobjective SWAT model calibration.
Users can define multiple objectives, each linked to spatial units such
as river reaches (<code>"rch"</code>), subbasins (<code>"sub"</code>), or HRUs
(<code>"hru"</code>). Each objective specifies target location, variable,
performance metric, and time step. This function is called by
<code><a href="calibrate_swat.html">calibrate_swat()</a></code> during optimization.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_objectives</span><span class="op">(</span><span class="va">parameter_values</span>, <span class="va">fn_args</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-parameter-values">parameter_values<a class="anchor" aria-label="anchor" href="#arg-parameter-values"></a></dt>
<dd><p>numeric. Vector of calibration parameter values.</p></dd>


<dt id="arg-fn-args">fn_args<a class="anchor" aria-label="anchor" href="#arg-fn-args"></a></dt>
<dd><p>list. Named list with inputs/configuration:</p><ul><li><p><code>objectives</code>: Calibration objectives.</p></li>
<li><p><code>observed_data</code>: Observed data for comparison.</p></li>
<li><p><code>output_config</code>: How to extract SWAT outputs.</p></li>
<li><p><code>parameter_info</code>: Parameter specifications.</p></li>
<li><p><code>subbasins</code>: Subbasin IDs to modify (<code>NULL</code> all).</p></li>
<li><p><code>swat_exe_path</code>: Path to the SWAT executable.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Numeric vector of objective values (one per objective in <code>objectives</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>objectives</strong>: list of objectives. Each element contains:</p><ul><li><p><code>element</code>: <code>"rch"</code>, <code>"sub"</code>, or <code>"hru"</code>.</p></li>
<li><p><code>variable</code>: e.g., <code>"FLOW_OUTcms"</code>.</p></li>
<li><p><code>target_id</code>: IDs to evaluate (type depends on element).</p></li>
<li><p><code>metric</code>: performance metric (see <a href="gof_metrics.html">gof_metrics</a>).</p></li>
<li><p><code>calib_time_step</code>: <code>"daily"</code> or <code>"monthly"</code>.</p></li>
<li><p><code>calib_start_date</code>: Start date of the calibration period.</p></li>
<li><p><code>calib_end_date</code>: End date of the calibration period.</p></li>
</ul><p>Example objectives (daily, reach 3, 2011-2013):</p><div class="sourceCode"><pre><code><span></span>
<span><span class="va">objectives</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    element          <span class="op">=</span> <span class="st">"rch"</span>,</span>
<span>    variable         <span class="op">=</span> <span class="st">"FLOW_OUTcms"</span>,</span>
<span>    target_id        <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    metric           <span class="op">=</span> <span class="st">"NSE"</span>,</span>
<span>    calib_time_step  <span class="op">=</span> <span class="st">"daily"</span>,</span>
<span>    calib_start_date <span class="op">=</span> <span class="st">"2011-01-01"</span>,</span>
<span>    calib_end_date   <span class="op">=</span> <span class="st">"2013-12-31"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    element          <span class="op">=</span> <span class="st">"rch"</span>,</span>
<span>    variable         <span class="op">=</span> <span class="st">"FLOW_OUTcms"</span>,</span>
<span>    target_id        <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    metric           <span class="op">=</span> <span class="st">"log_NSE"</span>,</span>
<span>    calib_time_step  <span class="op">=</span> <span class="st">"daily"</span>,</span>
<span>    calib_start_date <span class="op">=</span> <span class="st">"2011-01-01"</span>,</span>
<span>    calib_end_date   <span class="op">=</span> <span class="st">"2013-12-31"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>

<p><strong>observed_data</strong>: nested list by time step (<code>"daily"</code> or
<code>"monthly"</code>), spatial unit, and variable. Each terminal element is a
tibble with columns <code>Date</code>, <code>value</code>, <code>target_id</code>.</p>
<p>Example structure (daily, reach 3):</p><div class="sourceCode"><pre><code><span></span>
<span><span class="va">observed_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  daily <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    rch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="st">"FLOW_OUTcms"</span> <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>        Date      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2010-01-01"</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2013-12-31"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span>,</span>
<span>        value     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1461</span>, <span class="fl">1</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>        target_id <span class="op">=</span> <span class="fl">3</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>

<p><strong>output_config</strong>: how to read SWAT outputs for each element. These
arguments are passed to <a href="output_rch.html">output_rch</a>, <a href="output_sub.html">output_sub</a>, or
<a href="output_hru.html">output_hru</a>, as appropriate.</p><ul><li><p><code>file</code>: e.g., <code>"output.rch"</code>.</p></li>
<li><p><code>variable</code>: variables to extract.</p></li>
<li><p><code>target_id</code>: IDs to keep (<code>NULL</code> all).</p></li>
<li><p><code>time_step</code>: <code>"daily"</code> or <code>"monthly"</code>.</p></li>
<li><p><code>output_start_date</code>: date when SWAT begins writing outputs
        (typically after warm-up).</p></li>
</ul><p>Example (daily reach output; with a 1-year warm-up, outputs begin on
2011-01-01):</p><div class="sourceCode"><pre><code><span></span>
<span><span class="va">output_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  rch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    file              <span class="op">=</span> <span class="st">"output.rch"</span>,</span>
<span>    variable          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FLOW_OUTcms"</span><span class="op">)</span>,</span>
<span>    target_id         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    time_step         <span class="op">=</span> <span class="st">"daily"</span>,</span>
<span>    output_start_date <span class="op">=</span> <span class="st">"2011-01-01"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>

<p><strong>parameter_info</strong>: data frame/tibble describing parameter changes,
passed to <a href="change_multiple_parameters.html">change_multiple_parameters</a>. Columns:</p><ul><li><p><code>component</code>: e.g., <code>".gw"</code>, <code>".mgt"</code>, <code>".hru"</code>.</p></li>
<li><p><code>parameter</code>: parameter name.</p></li>
<li><p><code>value</code>: value/adjustment factor (filled internally).</p></li>
<li><p><code>method</code>: <code>"v"</code> (value) or <code>"r"</code> (relative).</p></li>
<li><p><code>version</code> (opt.): <code>"SWAT"</code> or <code>"SWAT_T"</code>.</p></li>
<li><p><code>plant_type</code> (opt.): plant type for <code>plant.dat</code>.</p></li>
</ul><p>See <a href="change_multiple_parameters.html">change_multiple_parameters</a> and <a href="change_parameter.html">change_parameter</a> for
details; list of available parameters: <a href="get_swat_parameters.html">get_swat_parameters</a>.</p>
<p><strong>swat_exe_path</strong>: path to the SWAT executable.</p>
<p><strong>subbasins</strong> (optional): vector of subbasin IDs (<code>NULL</code> all).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>When used via <code><a href="calibrate_swat.html">calibrate_swat()</a></code> with
<code>fn = calculate_objectives</code> (the package default),
<code>fn_args</code> is validated upstream to avoid per-iteration overhead.
If you pass a custom <code>fn</code>, <code><a href="calibrate_swat.html">calibrate_swat()</a></code> does not validate
its inputs; your function must validate <code>fn_args</code> (or you must
validate it before calling <code><a href="calibrate_swat.html">calibrate_swat()</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="run_swat_exe.html">run_swat_exe</a></p>
<p>Other Multiobjective calibration:
<code><a href="best_compromise_solution.html">best_compromise_solution()</a></code>,
<code><a href="calibrate_swat.html">calibrate_swat()</a></code>,
<code><a href="create_calibration_project.html">create_calibration_project()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Windows-only example (runs SWAT once to compute objectives).</span></span></span>
<span class="r-in"><span><span class="co"># On non-Windows, skip or provide your own compiled swat.exe.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">tmpdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">swat_project</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_swat_example.html">get_swat_example</a></span><span class="op">(</span><span class="va">tmpdir</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="create_calibration_project.html">create_calibration_project</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    swat_TxtInOut   <span class="op">=</span> <span class="va">swat_project</span>,</span></span>
<span class="r-in"><span>    destination_dir <span class="op">=</span> <span class="va">tmpdir</span>,</span></span>
<span class="r-in"><span>    project_name    <span class="op">=</span> <span class="st">"calc_obj_example"</span>,</span></span>
<span class="r-in"><span>    set_working_dir <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># SWAT executable (if download fails, set your local path below)</span></span></span>
<span class="r-in"><span>  <span class="va">swat_exe</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="download_swat_exe.html">download_swat_exe</a></span><span class="op">(</span>dest_dir <span class="op">=</span> <span class="va">tmpdir</span>, type <span class="op">=</span> <span class="st">"release"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"download_swat_exe() failed: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">conditionMessage</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="st">"path/to/swat.exe"</span>  <span class="co"># &lt;-- set your local executable</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Simulation setup (warm-up = 1 year)</span></span></span>
<span class="r-in"><span>  <span class="va">setup_swat_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="setup_swat.html">setup_swat</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    sim_start_date <span class="op">=</span> <span class="st">"2010-01-01"</span>,</span></span>
<span class="r-in"><span>    sim_end_date   <span class="op">=</span> <span class="st">"2013-12-31"</span>,</span></span>
<span class="r-in"><span>    time_step      <span class="op">=</span> <span class="st">"daily"</span>,</span></span>
<span class="r-in"><span>    NYSKIP         <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    rch_vars       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FLOW_OUTcms"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Objectives (NSE and log_NSE at reach 3; 2011-01-01 to 2013-12-31)</span></span></span>
<span class="r-in"><span>  <span class="va">objectives</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      element          <span class="op">=</span> <span class="st">"rch"</span>,</span></span>
<span class="r-in"><span>      variable         <span class="op">=</span> <span class="st">"FLOW_OUTcms"</span>,</span></span>
<span class="r-in"><span>      target_id        <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>      metric           <span class="op">=</span> <span class="st">"NSE"</span>,</span></span>
<span class="r-in"><span>      calib_time_step  <span class="op">=</span> <span class="st">"daily"</span>,</span></span>
<span class="r-in"><span>      calib_start_date <span class="op">=</span> <span class="st">"2011-01-01"</span>,</span></span>
<span class="r-in"><span>      calib_end_date   <span class="op">=</span> <span class="st">"2013-12-31"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      element          <span class="op">=</span> <span class="st">"rch"</span>,</span></span>
<span class="r-in"><span>      variable         <span class="op">=</span> <span class="st">"FLOW_OUTcms"</span>,</span></span>
<span class="r-in"><span>      target_id        <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>      metric           <span class="op">=</span> <span class="st">"log_NSE"</span>,</span></span>
<span class="r-in"><span>      calib_time_step  <span class="op">=</span> <span class="st">"daily"</span>,</span></span>
<span class="r-in"><span>      calib_start_date <span class="op">=</span> <span class="st">"2011-01-01"</span>,</span></span>
<span class="r-in"><span>      calib_end_date   <span class="op">=</span> <span class="st">"2013-12-31"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Observed flows (qobserved) provided with the package</span></span></span>
<span class="r-in"><span>  <span class="va">observed_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    daily <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      rch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"FLOW_OUTcms"</span> <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>          Date      <span class="op">=</span> <span class="va">qobserved</span><span class="op">$</span><span class="va">Date</span>,</span></span>
<span class="r-in"><span>          value     <span class="op">=</span> <span class="va">qobserved</span><span class="op">$</span><span class="va">Flow</span>,</span></span>
<span class="r-in"><span>          target_id <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># What to read from SWAT outputs</span></span></span>
<span class="r-in"><span>  <span class="va">output_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      file              <span class="op">=</span> <span class="st">"output.rch"</span>,</span></span>
<span class="r-in"><span>      variable          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FLOW_OUTcms"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      target_id         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      time_step         <span class="op">=</span> <span class="st">"daily"</span>,</span></span>
<span class="r-in"><span>      output_start_date <span class="op">=</span> <span class="va">setup_swat_out</span><span class="op">$</span><span class="va">output_start_date</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Parameters and bounds (values filled when evaluating objectives)</span></span></span>
<span class="r-in"><span>  <span class="va">parameter_info</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    component  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".gw"</span>, <span class="st">".gw"</span>, <span class="st">".gw"</span>, <span class="st">".gw"</span>, <span class="st">".hru"</span>, <span class="st">".hru"</span>, <span class="st">".mgt"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    parameter  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GW_DELAY"</span>, <span class="st">"ALPHA_BF"</span>, <span class="st">"GWQMN"</span>, <span class="st">"RCHRG_DP"</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"SURLAG"</span>, <span class="st">"ESCO"</span>, <span class="st">"CN2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    value      <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    method     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"v"</span>, <span class="st">"v"</span>, <span class="st">"v"</span>, <span class="st">"v"</span>, <span class="st">"v"</span>, <span class="st">"v"</span>, <span class="st">"r"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    version    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"SWAT"</span>, <span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    plant_type <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    min        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0.50</span>, <span class="fl">700</span>, <span class="fl">0.05</span>, <span class="fl">1.0</span>, <span class="fl">0.90</span>, <span class="op">-</span><span class="fl">0.05</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    max        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">1.00</span>, <span class="fl">750</span>, <span class="fl">0.50</span>, <span class="fl">2.0</span>, <span class="fl">1.00</span>,  <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Assemble arguments for objective computation</span></span></span>
<span class="r-in"><span>  <span class="va">fn_args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    parameter_info <span class="op">=</span> <span class="va">parameter_info</span>,</span></span>
<span class="r-in"><span>    observed_data  <span class="op">=</span> <span class="va">observed_data</span>,</span></span>
<span class="r-in"><span>    output_config  <span class="op">=</span> <span class="va">output_config</span>,</span></span>
<span class="r-in"><span>    objectives     <span class="op">=</span> <span class="va">objectives</span>,</span></span>
<span class="r-in"><span>    subbasins      <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    swat_exe_path  <span class="op">=</span> <span class="va">swat_exe</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Single evaluation for a candidate parameter vector</span></span></span>
<span class="r-in"><span>  <span class="va">obj_vals</span> <span class="op">&lt;-</span> <span class="fu">calculate_objectives</span><span class="op">(</span></span></span>
<span class="r-in"><span>    parameter_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">0.8</span>, <span class="fl">725</span>, <span class="fl">0.2</span>, <span class="fl">1.3</span>, <span class="fl">0.95</span>, <span class="fl">0.00</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    fn_args          <span class="op">=</span> <span class="va">fn_args</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">obj_vals</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Windows-only example. On non-Windows, compile SWAT and set 'swat_exe'."</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Windows-only example. On non-Windows, compile SWAT and set 'swat_exe'.</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carlos Antonio Fernandez Palomino.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

